<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Python Compiler</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.2/full/pyodide.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/addon/edit/matchbrackets.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #1e1e2f;
            color: white;
            display: flex;
            height: 100vh;
        }

        .container {
            display: flex;
            width: 100%;
        }

        .question-panel {
            width: 35%;
            padding: 20px;
            background-color: #252535;
            border-right: 2px solid #444;
            overflow-y: auto;
        }

        .question-panel h1 {
            color: #ffa500;
            margin-bottom: 20px;
        }

        .code-panel {
            width: 65%;
            display: flex;
            flex-direction: column;
        }

        .editor-container {
            flex: 1;
            padding: 10px;
            background-color: #252535;
        }

        .run-container {
            display: flex;
            justify-content: flex-end;
            padding: 10px;
            background-color: #252535;
        }

        .run-btn {
            background-color: #ff9d00;
            border: none;
            color: black;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        .run-btn:hover {
            background-color: #d87d00;
        }

        .output-section {
            display: flex;
            padding: 10px;
            gap: 10px;
            background-color: #252535;
        }

        .output-box {
            flex: 1;
            padding: 10px;
            background-color: #1e1e2f;
            border-radius: 5px;
            border: 1px solid #444;
            color: white;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre-wrap;
            overflow: auto;
            height: 200px;
        }

        .output-box.success {
            border-color: #4caf50;
        }

        .output-box.error {
            border-color: #f44336;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="question-panel">
            <h1>Print Pattern</h1>
            <p>
                Write code to print a pattern based on the number of rows.
                Example: If the input is 5, the output should be:
            </p>
            <pre>
*
**
***
****
*****
            </pre>
            <h3>Input:</h3>
            <pre>5</pre>
            <h3>Output:</h3>
            <pre>
*
**
***
****
*****
            </pre>
        </div>
        
        <div class="code-panel">
            <div class="editor-container" id="editor"></div>
            <div class="run-container">
                <button class="run-btn" id="run-btn">Run Code</button>
            </div>
            <div class="output-section">
                <div class="output-box success" id="output">Output will appear here...</div>
                <div class="output-box error" id="error">Errors will appear here...</div>
            </div>
        </div>
    </div>

    <script>
        let pyodide, editor;

        async function initPyodide() {
            if (!pyodide) {
                pyodide = await loadPyodide();
            }
        }

        async function runCode() {
            await initPyodide();
            const userCode = editor.getValue();
            const outputBox = document.getElementById('output');
            const errorBox = document.getElementById('error');
        
            outputBox.textContent = '';
            errorBox.textContent = '';
        
            try {
                const codeToRun = `
        import sys
        from io import StringIO
        # Capturing the print output
        old_stdout = sys.stdout
        sys.stdout = StringIO()
        
        # Print pattern code
        for i in range(1, 6):
            for j in range(0, i):
                print("*", end="")
            print()
        
        # Get the captured output
        output = sys.stdout.getvalue()
        
        # Reset stdout
        sys.stdout = old_stdout
        
        output
        `;
        
                const output = await pyodide.runPythonAsync(codeToRun);
        
                if (output) {
                    outputBox.textContent = `Output:\n${output}`;
                    outputBox.classList.add('success');
                    outputBox.classList.remove('error');
                } else {
                    outputBox.textContent = 'No output produced.';
                    outputBox.classList.add('error');
                    outputBox.classList.remove('success');
                }
        
            } catch (error) {
                errorBox.textContent = `Error:\n${error.message}`;
                errorBox.classList.add('error');
                errorBox.classList.remove('success');
            }
        }


        editor = CodeMirror(document.getElementById('editor'), {
            mode: 'python',
            theme: 'dracula',
            lineNumbers: true,
            autoCloseBrackets: true,
            matchBrackets: true,
            tabSize: 4,
            indentWithTabs: true,
        });

        document.getElementById('run-btn').addEventListener('click', runCode);
    </script>
</body>
</html>
